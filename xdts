--// Services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera

--// GUI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ExampleGUI"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.Parent = game:GetService("CoreGui")

-- Outer frame
local outerFrame = Instance.new("Frame")
outerFrame.Size = UDim2.new(0.6, 0, 0.7, 0)
outerFrame.Position = UDim2.new(0.15, 0, 0.15, 0)
outerFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
outerFrame.BorderSizePixel = 0
outerFrame.Parent = screenGui

-- Toggle button
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0.12, 0, 0.05, 0)
toggleButton.Position = UDim2.new(0.44, 0, 0.85, 0)
toggleButton.Text = "Hide Frame"
toggleButton.TextColor3 = Color3.fromRGB(255,255,255)
toggleButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
toggleButton.Parent = screenGui

toggleButton.MouseButton1Click:Connect(function()
    outerFrame.Visible = not outerFrame.Visible
    toggleButton.Text = outerFrame.Visible and "Hide Frame" or "Show Frame"
end)

-- Drag functionality
local dragging = false
local dragStart = Vector2.new()
local startPos = UDim2.new()

toggleButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = toggleButton.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

toggleButton.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
        local delta = input.Position - dragStart
        local screenSize = toggleButton.Parent.AbsoluteSize
        toggleButton.Position = UDim2.new(
            startPos.X.Scale + delta.X / screenSize.X,
            0,
            startPos.Y.Scale + delta.Y / screenSize.Y,
            0
        )
    end
end)

-- Helper function to create scrolling frames + layouts
local function createScrollFrame(parent, size, pos)
    local frame = Instance.new("ScrollingFrame")
    frame.Size = size
    frame.Position = pos
    frame.CanvasSize = UDim2.new(0,0,0,0)
    frame.ScrollBarThickness = 8
    frame.BackgroundColor3 = Color3.fromRGB(35,35,35)
    frame.Parent = parent

    local layout = Instance.new("UIListLayout")
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0,2)
    layout.Parent = frame

    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        frame.CanvasSize = UDim2.new(0,0,0,layout.AbsoluteContentSize.Y)
    end)

    return frame
end

-- Helper function to create buttons
local function createButton(parent, text, posY)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.15,0,0.08,0)
    btn.Position = UDim2.new(0.3,0,posY,0)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255,255,255)
    btn.BackgroundColor3 = Color3.fromRGB(80,80,80)
    btn.Parent = parent
    return btn
end

-- Create Items Frame
local itemsFrame = Instance.new("Frame")
itemsFrame.Size = UDim2.new(0.8, 0, 0.9, 0)
itemsFrame.Position = UDim2.new(0.199, 0.05, 0.1, 0)
itemsFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
itemsFrame.Parent = outerFrame

-- Items Frame UI
local selectedLabel = Instance.new("TextLabel")
selectedLabel.Size = UDim2.new(0.38,0,0.08,0)
selectedLabel.Position = UDim2.new(0.45,0,0.05,0)
selectedLabel.Text = "Selected Item: None"
selectedLabel.TextColor3 = Color3.fromRGB(255,255,255)
selectedLabel.BackgroundColor3 = Color3.fromRGB(50,50,50)
selectedLabel.TextScaled = true
selectedLabel.TextWrapped = true
selectedLabel.Parent = itemsFrame

local scrollFrameLeft = createScrollFrame(itemsFrame, UDim2.new(0.2,0,0.7,0), UDim2.new(0.48,0,0.15,0))
local scrollFrameRight = createScrollFrame(itemsFrame, UDim2.new(0.3,0,0.7,0), UDim2.new(0.7,0,0.15,0))

local bringAllButton = createButton(itemsFrame,"Bring All",0.15)
local bringOneButton = createButton(itemsFrame,"Bring One",0.25)
local bringAllItemButton = createButton(itemsFrame,"Bring All of Item",0.35)
local mouseSphereButton = createButton(itemsFrame,"Mouse Sphere",0.45)
local bringAllOnePosButton = createButton(itemsFrame,"Bring All of One Pos",0.55)
local loopBringButton = createButton(itemsFrame,"Loop Bring",0.65)

local yLevelBox = Instance.new("TextBox")
yLevelBox.Size = UDim2.new(0.15,0,0.05,0)
yLevelBox.Position = UDim2.new(0.3,0,0.75,0)
yLevelBox.PlaceholderText = "Y-Level Offset"
yLevelBox.Text = "5"
yLevelBox.ClearTextOnFocus = false
yLevelBox.TextColor3 = Color3.fromRGB(255,255,255)
yLevelBox.BackgroundColor3 = Color3.fromRGB(60,60,60)
yLevelBox.Parent = itemsFrame

-- Create Player Frame (mirrors Items Frame layout)
local playerFrame = Instance.new("Frame")
playerFrame.Size = UDim2.new(0.8,0,0.9,0)
playerFrame.Position = UDim2.new(0.199,0,0.1,0)
playerFrame.BackgroundColor3 = Color3.fromRGB(50,50,50)
playerFrame.Parent = outerFrame
playerFrame.Visible = false

-- Player Frame UI
local playerLabel = Instance.new("TextLabel")
playerLabel.Size = UDim2.new(0.38,0,0.08,0)
playerLabel.Position = UDim2.new(0.45,0,0.05,0)
playerLabel.Text = "Player Info"
playerLabel.TextColor3 = Color3.fromRGB(255,255,255)
playerLabel.BackgroundColor3 = Color3.fromRGB(50,50,50)
playerLabel.TextScaled = true
playerLabel.TextWrapped = true
playerLabel.Parent = playerFrame

local playerScrollLeft = createScrollFrame(playerFrame, UDim2.new(0.2,0,0.7,0), UDim2.new(0.48,0,0.15,0))
local playerScrollRight = createScrollFrame(playerFrame, UDim2.new(0.3,0,0.7,0), UDim2.new(0.7,0,0.15,0))

-- Placeholder player buttons
createButton(playerFrame,"Teleport To Player",0.15)
createButton(playerFrame,"Heal Player",0.25)
createButton(playerFrame,"Give Item",0.35)

-- Items / Player Toggle Buttons
local itemsButton = Instance.new("TextButton")
itemsButton.Size = UDim2.new(0,100,0,30)
itemsButton.Position = UDim2.new(0,0,0,0)
itemsButton.Text = "Items"
itemsButton.BackgroundColor3 = Color3.fromRGB(70,70,70)
itemsButton.TextColor3 = Color3.fromRGB(255,255,255)
itemsButton.Parent = outerFrame

local playerButton = Instance.new("TextButton")
playerButton.Size = UDim2.new(0,100,0,30)
playerButton.Position = UDim2.new(0,110,0,0)
playerButton.Text = "Player"
playerButton.BackgroundColor3 = Color3.fromRGB(70,70,70)
playerButton.TextColor3 = Color3.fromRGB(255,255,255)
playerButton.Parent = outerFrame

itemsButton.Activated:Connect(function()
    itemsFrame.Visible = true
    playerFrame.Visible = false
end)

playerButton.Activated:Connect(function()
    playerFrame.Visible = true
    itemsFrame.Visible = false
end)

-- Close button
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0.15,0,0.08,0)
closeButton.Position = UDim2.new(0.85,0,0,0)
closeButton.Text = "Close"
closeButton.TextColor3 = Color3.fromRGB(255,255,255)
closeButton.BackgroundColor3 = Color3.fromRGB(80,80,80)
closeButton.Parent = outerFrame

closeButton.MouseButton1Click:Connect(function()
    if toggleButton then toggleButton:Destroy() end
    outerFrame:Destroy()
end)
